2023-11-24 21:40:48,750 - root - INFO - inpu size :320
priors nums:4420
2023-11-24 21:40:49,562 - root - INFO - Use Cuda.
2023-11-24 21:40:49,562 - root - INFO - Namespace(dataset_type='voc', datasets=['./data/wider_face_add_lm_10_10'], validation_dataset='./data/wider_face_add_lm_10_10', balance_data=False, net='RFB', freeze_base_net=False, freeze_net=False, lr=0.01, momentum=0.9, weight_decay=0.0005, gamma=0.1, base_net_lr=None, extra_layers_lr=None, base_net=None, pretrained_ssd=None, resume=None, scheduler='multi-step', milestones='95,150', t_max=120, batch_size=24, num_epochs=200, num_workers=0, validation_epochs=5, debug_steps=100, use_cuda=True, checkpoint_folder='./models/train-version-RFB', log_dir='./models/train-version-RFB/logs', cuda_index='0', power=2, overlap_threshold=0.35, optimizer_type='SGD', input_size=320)
2023-11-24 21:40:49,563 - root - INFO - Prepare training datasets.
2023-11-24 21:40:49,569 - root - INFO - No labels file, using default VOC classes.
2023-11-24 21:40:49,569 - root - INFO - Stored labels into file ./models/train-version-RFB/voc-model-labels.txt.
2023-11-24 21:40:49,570 - root - INFO - Train dataset size: 12859
2023-11-24 21:40:49,570 - root - INFO - Prepare Validation datasets.
2023-11-24 21:40:49,572 - root - INFO - No labels file, using default VOC classes.
2023-11-24 21:40:49,572 - root - INFO - validation dataset size: 3219
2023-11-24 21:40:49,572 - root - INFO - Build network.
2023-11-24 21:40:49,857 - root - INFO - use gpu :[0]
2023-11-24 21:40:49,858 - root - INFO - Took 0.00 seconds to load the model.
2023-11-24 21:40:49,863 - root - INFO - Learning rate: 0.01, Base net learning rate: 0.01, Extra Layers learning rate: 0.01.
2023-11-24 21:40:49,863 - root - INFO - Uses MultiStepLR scheduler.
2023-11-24 21:40:49,863 - root - INFO - Start training from epoch 0.
Traceback (most recent call last):
  File "/media/sento/New Volume/workspace/retinaface/Ultra-Light-Fast-Generic-Face-Detector-1MB/train.py", line 357, in <module>
    train(train_loader, net, criterion, optimizer,
  File "/media/sento/New Volume/workspace/retinaface/Ultra-Light-Fast-Generic-Face-Detector-1MB/train.py", line 136, in train
    for i, data in enumerate(loader):
  File "/media/sento/New Volume/workspace/retinaface/.venv/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/media/sento/New Volume/workspace/retinaface/.venv/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 674, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/media/sento/New Volume/workspace/retinaface/.venv/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/media/sento/New Volume/workspace/retinaface/.venv/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/media/sento/New Volume/workspace/retinaface/.venv/lib/python3.10/site-packages/torch/utils/data/dataset.py", line 302, in __getitem__
    return self.datasets[dataset_idx][sample_idx]
  File "/media/sento/New Volume/workspace/retinaface/Ultra-Light-Fast-Generic-Face-Detector-1MB/vision/datasets/voc_dataset.py", line 61, in __getitem__
    image, boxes, labels = self.transform(image, boxes, labels)
  File "/media/sento/New Volume/workspace/retinaface/Ultra-Light-Fast-Generic-Face-Detector-1MB/vision/ssd/data_preprocessing.py", line 33, in __call__
    return self.augment(img, boxes, labels)
  File "/media/sento/New Volume/workspace/retinaface/Ultra-Light-Fast-Generic-Face-Detector-1MB/vision/transforms/transforms.py", line 75, in __call__
    img, boxes, labels = t(img, boxes, labels)
  File "/media/sento/New Volume/workspace/retinaface/Ultra-Light-Fast-Generic-Face-Detector-1MB/vision/transforms/transforms.py", line 383, in __call__
    mode = random.choice(self.sample_options)
  File "numpy/random/mtrand.pyx", line 936, in numpy.random.mtrand.RandomState.choice
ValueError: setting an array element with a sequence. The requested array has an inhomogeneous shape after 1 dimensions. The detected shape was (5,) + inhomogeneous part.
